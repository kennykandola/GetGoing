$("#modal-step-content").hide().html("<%= escape_javascript(render( partial: 'posts/post_steps/accommodations', locals: { })).html_safe %>").fadeIn("slow");
$("#modal-component").modal("show");

var slider = document.getElementById('accommodations-price-slider');
var minCostInput = document.getElementById('post_min_accomodation_price'),
		maxCostInput = document.getElementById('post_max_accomodation_price');

var initialMin = minCostInput.value,
    initialMax = maxCostInput.value

if (typeof initialMin === 'undefined' || initialMin === null || initialMin === "") {
    initialMin = 0;
}

if (typeof initialMax === 'undefined' || initialMax === null || initialMax === "") {
    initialMax = 500;
}

noUiSlider.create(slider, {
	start: [initialMin, initialMax],
	connect: true,
  // tooltips: true,
  format: wNumb({
		decimals: 0
	}),
	range: {
		'min': 0,
		'max': 500
	}
});;

if (typeof formTouched === 'undefined' )
{
  var formTouched = false
}

var skipToNext = function(){
  $('#submit-button').text('Next');
  $('#submit-button').val('Next');
  formTouched = true
};

if (formTouched) {
  skipToNext();
}

// $('#submit-button').text('Skip')
// $('#submit-button').val('Skip')

slider.noUiSlider.on('update', function( values, handle ) {
  if ( handle ) {
			maxCostInput.value = values[handle];
		} else {
			minCostInput.value = values[handle];
		}
});

slider.noUiSlider.on('slide', function(){
	skipToNext();
});

minCostInput.addEventListener('change', function(){
	slider.noUiSlider.set([this.value, null]);
});

maxCostInput.addEventListener('change', function(){
	slider.noUiSlider.set([null, this.value]);
});

$('.star').raty({
  readOnly: true,
  score: function() {
    return $(this).attr('data-score');
  }
});


$(".modal-content").addClass('recommendations-modal');

bar.animate(0.6);  // Number from 0.0 to 1.0
$('.modal-header h3').hide().text('Accommodations').fadeIn("slow");
$('.modal-header p').fadeIn("slow");

$(document).on('change', 'select', function() {
  skipToNext();
});

$(document).on('change', 'input', function() {
  skipToNext();
});
